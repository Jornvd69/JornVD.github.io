<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>C# Code Voorbeelden</title>

   
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- Eigen CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header>
    <h1>Welkom op mijn website!</h1>
    <p>Hier kan je mijn code en projecten bekijken</p>
</header>

<main>

    <div class="example">
        <h2>Code die via een database patienten kan tonen en ook de gebruiker notities kan laten toevoegen.</h2>
        <pre><code class="language-csharp">
using System;
using System.Data;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace HuisartsProject
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            InitializeDataGridView();
        }

        string connectionString = "Server=localhost;Database=huisartsenpraktijk;User=root;";

        private void InitializeDataGridView()
        {
            Results.ColumnCount = 8;
            Results.Columns[0].Name = "ID";
            Results.Columns[1].Name = "Voornaam";
            Results.Columns[2].Name = "Achternaam";
            Results.Columns[3].Name = "Adres";
            Results.Columns[4].Name = "Huisnummer";
            Results.Columns[5].Name = "Postcode";
            Results.Columns[6].Name = "Plaats";
            Results.Columns[7].Name = "Telefoonnummer";
        }

     
        private int GetSelectedPatientID()
        {
            if (Results.SelectedRows.Count == 0)
                return -1;

            return Convert.ToInt32(Results.SelectedRows[0].Cells["ID"].Value);
        }

    
        private void btnSlaNotitieOp_Click(object sender, EventArgs e)
        {
            int patientID = GetSelectedPatientID();

            if (patientID == -1)
            {
                MessageBox.Show("Selecteer eerst een patiënt.");
                return;
            }

            string notitie = txtNotitie.Text.Trim();

            if (string.IsNullOrEmpty(notitie))
            {
                MessageBox.Show("Vul een notitie in.");
                return;
            }

            string query = "INSERT INTO Notities (PatientID, Notitie) VALUES (@pid, @note)";

            using (MySqlConnection conn = new MySqlConnection(connectionString))
            using (MySqlCommand cmd = new MySqlCommand(query, conn))
            {
                cmd.Parameters.AddWithValue("@pid", patientID);
                cmd.Parameters.AddWithValue("@note", notitie);

                try
                {
                    conn.Open();
                    cmd.ExecuteNonQuery();
                    MessageBox.Show("Notitie opgeslagen!");

                    txtNotitie.Clear();
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Fout: " + ex.Message, "Databasefout",
                                    MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }
        }
        private void btnVerwijderPatient_Click(object sender, EventArgs e)
        {
            
            if (Results.SelectedRows.Count == 0)
            {
                MessageBox.Show("Selecteer een patiënt om te verwijderen.");
                return;
            }

           
            int patientId = Convert.ToInt32(Results.SelectedRows[0].Cells["ID"].Value);

            // Vraag bevestiging
            DialogResult result = MessageBox.Show(
                $"Weet je zeker dat je patiënt ID {patientId} wilt verwijderen? Alle notities worden ook verwijderd.",
                "Bevestiging verwijderen",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (result == DialogResult.Yes)
            {
                
                using (MySqlConnection conn = new MySqlConnection(connectionString))
                using (MySqlCommand cmd = new MySqlCommand("DELETE FROM patienten WHERE ID = @id", conn))
                {
                    cmd.Parameters.AddWithValue("@id", patientId);

                    try
                    {
                        conn.Open();
                        int rowsAffected = cmd.ExecuteNonQuery();

                        if (rowsAffected > 0)
                        {
                            MessageBox.Show("Patiënt en bijbehorende notities succesvol verwijderd.");
                            Results.Rows.RemoveAt(Results.SelectedRows[0].Index);
                        }
                        else
                        {
                            MessageBox.Show("Geen patiënt gevonden met dit ID.");
                        }
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show("Fout bij verwijderen: " + ex.Message);
                    }
                }
            }
        }

        private void btnHaalNotitieOp_Click(object sender, EventArgs e)
        {
            int patientID = GetSelectedPatientID();

            if (patientID == -1)
            {
                MessageBox.Show("Selecteer eerst een patiënt.");
                return;
            }

            string query = "SELECT Notitie FROM Notities WHERE PatientID = @pid";
            using (MySqlConnection conn = new MySqlConnection(connectionString))
            using (MySqlCommand cmd = new MySqlCommand(query, conn))
            {
               
                cmd.Parameters.AddWithValue("@pid", patientID);

                try
                {
                    conn.Open();

                    MessageBox.Show("Notities voor patiënt ID " + patientID + ":");

                    using (MySqlDataReader reader = cmd.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                MessageBox.Show(reader["Notitie"].ToString());
                            }
                        }
                        else
                        {
                            MessageBox.Show("Geen notities gevonden voor deze patiënt.");
                        }
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Fout: " + ex.Message, "Databasefout",
                                    MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }
        }


        private void btnzoekpatient_Click(object sender, EventArgs e)
        {
            string searchText = textBox1.Text.Trim();

            if (string.IsNullOrEmpty(searchText))
            {
                MessageBox.Show("Vul een naam in om te zoeken.");
                return;
            }

            string query = "SELECT ID, Voornaam, Achternaam, Adres, Huisnummer, Postcode, Plaats, Telefoonnummer FROM patienten WHERE Achternaam LIKE @search";

            Results.Rows.Clear();

            using (MySqlConnection conn = new MySqlConnection(connectionString))
            using (MySqlCommand cmd = new MySqlCommand(query, conn))
            {
                cmd.Parameters.AddWithValue("@search",  searchText + "%");

                try
                {
                    conn.Open();
                    using (MySqlDataReader reader = cmd.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                Results.Rows.Add(
                                    reader["ID"].ToString(),
                                    reader["Voornaam"].ToString(),
                                    reader["Achternaam"].ToString(),
                                    reader["Adres"].ToString(),
                                    reader["Huisnummer"].ToString(),
                                    reader["Postcode"].ToString(),
                                    reader["Plaats"].ToString(),
                                    reader["Telefoonnummer"].ToString()
                                );
                            }
                        }
                        else
                        {
                            MessageBox.Show("Geen patiënten gevonden.");
                        }
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Fout: " + ex.Message, "Databasefout",
                                    MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }
        }

        private void Form1_Load(object sender, EventArgs e) { }

  
    }
}

        </code></pre>
    </div>

    <div class="example">
        <h2></h2>
        <pre><code class="language-csharp">

        </code></pre>
    </div>

</main>

<footer>
    © 2025 - C# Voorbeelden Website
</footer>

<!-- Prism.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>

</body>
</html>
